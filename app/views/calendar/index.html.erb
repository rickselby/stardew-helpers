<turbo-frame id="calendar">
  <div class="row panel">
    <div class="wood-border">
      <%= render 'villagers' %>
      <%= render 'calendar' %>
    </div>
  </div>

  <div class="row panel" v-if="schedules.length !== 0">
    <div class="wood-border">
      <h3>How to read the schedules</h3>
      <p>
        Read the panels from left to right. The first panel that applies should be the
        villager's schedule for the day. There many be alternatives for rain, for buildings
        being unavailable, or based on friendship that will override the regular schedule for
        a day.
      </p>
      <p>
        The times shown are when the villager will leave their previous location and head
        to the listed location.
      </p>
    </div>
  </div>

  <div class="row panel">
    <div class="wood-border">
      <div class="row">
        <div class="col-12" v-if="schedules.length === 0">
          Select a villager and a date, and their possible schedules will appear here.
        </div>
        <h4 class="col-12 text-center" v-if="schedules.length !== 0">
          {{ selected }}
        </h4>
        <template v-for="schedule in possibilities">
          <div class="panel route-panel" v-bind:class="schedulePanelClasses(schedule)">
            <div class="bulletin">
              <div class="panel-heading">
                <h4>
                  {{ schedule.notes }}
                  <span v-if="schedule.doubleRain">
                      (equal chance of either)
                    </span>
                </h4>
              </div>
              <div class="row">
                <div class="list-group list-group-flush" v-bind:class="scheduleClasses(schedule)">
                  <template v-for="route in schedule.routes">
                    <button type="button" class="list-group-item" data-bs-toggle="modal" data-bs-target="#mapModal" v-on:click="setRoute(route)">
                      {{ formatTime(route.time) }}:
                      {{ route.name }}
                    </button>
                  </template>
                </div>
                <div class="list-group list-group-flush" v-bind:class="scheduleClasses(schedule)" v-if="schedule.doubleRain">
                  <template v-for="route in schedule.doubleRainRoutes">
                    <button type="button" class="list-group-item" data-bs-toggle="modal" data-bs-target="#mapModal" v-on:click="setRoute(route)">
                      {{ formatTime(route.time) }}:
                      {{ route.name }}
                    </button>
                  </template>
                </div>
              </div>
            </div>
          </div>
        </template>
      </div>
    </div>
  </div>

  <div class="modal" tabindex="-1" id="mapModal">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body">
          <img v-bind:src="mapPath" />
        </div>
      </div>
    </div>
  </div>
</turbo-frame>
